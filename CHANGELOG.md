# 更新日志 (CHANGELOG)

## v2.0.0 - 2024-08-24

### 🚀 重大更新：数据库迁移

#### 数据库架构重构
- **迁移至Cloudflare D1**: 从MySQL数据库完全迁移到Cloudflare D1（全球分布式SQLite）
- **移除外键约束**: 为了避免删除操作的约束问题，重新设计了无外键约束的数据库架构
- **应用层关联**: 数据关联关系现在由应用层逻辑维护，提高了灵活性和性能

#### 安全性改进
- **敏感信息清理**: 完全移除了所有MySQL连接配置和敏感信息
- **无服务器安全**: 采用Cloudflare企业级安全保障，无需管理数据库服务器安全

#### 性能优化
- **全球分布**: 数据在全球边缘节点复制，显著提高访问速度
- **零冷启动**: 无服务器架构，消除了数据库连接延迟
- **自动缩放**: 根据使用量自动调整性能和容量

#### 删除的功能和文件
- ❌ 移除所有MySQL相关配置文件
- ❌ 删除MySQL初始化脚本
- ❌ 清理MySQL连接配置
- ❌ 移除重复的Worker文件版本

#### 新增功能
- ✅ 无外键约束的安全删除策略
- ✅ 丰富的测试数据集
- ✅ 完整的D1数据库架构
- ✅ 自动化数据库初始化

#### 技术栈更新
```diff
- MySQL数据库
+ Cloudflare D1数据库（SQLite）

- 需要数据库服务器维护
+ 完全无服务器架构

- 外键约束管理
+ 应用层关联管理
```

### 🔧 配置变更

#### wrangler.toml
```diff
- 移除MySQL环境变量
+ 添加D1数据库绑定
```

#### 数据库连接
```diff
- MySQL TCP连接
+ D1 SQLite API
```

### 📊 数据迁移

#### 测试数据
- 2个测试用户
- 10个不同类型资产
- 3个负债项目  
- 40条现金流记录
- 完整的资产价值历史

#### 数据完整性
- 所有原有功能保持不变
- 数据结构完全兼容
- 前端无需任何修改

### ⚠️ 破坏性变更

1. **数据库类型变更**: 从MySQL迁移到SQLite（D1）
2. **外键约束移除**: 不再依赖数据库级外键约束
3. **配置文件更新**: wrangler.toml配置格式变更

### 📝 迁移指南

#### 对于新部署
直接使用新的配置即可，无需额外操作。

#### 对于现有部署
1. 数据已自动迁移到D1
2. 更新wrangler.toml配置
3. 重新部署应用

### 🎯 下一步计划

- [ ] 添加数据导出/导入功能
- [ ] 实现数据库备份策略
- [ ] 优化查询性能
- [ ] 添加数据分析功能

---

## v1.x.x - 历史版本

### v1.2.0 - MySQL版本（已弃用）
- 使用MySQL数据库
- 包含外键约束
- 需要数据库服务器维护

### v1.1.0 - 初始版本
- 基础资产管理功能
- 简单的数据库架构
- 基本的前端界面